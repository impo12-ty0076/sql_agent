# Implementation Plan: SQL DB LLM Agent System

## 구현 계획 개요

이 구현 계획은 SQL DB LLM Agent 시스템의 개발을 위한 단계별 작업 목록입니다. 각 작업은 테스트 주도 개발 방식으로 접근하며, 점진적으로 기능을 구현하고 통합합니다. 작업은 우선순위와 의존성에 따라 순서가 지정되었습니다.

## 작업 목록

- [x] 1. 프로젝트 초기 설정 및 기본 구조 구축

  - 프로젝트 디렉토리 구조 생성, 기본 설정 파일 작성
  - 개발 환경 설정 (ESLint, Prettier, TypeScript 등)
  - 기본 의존성 설치 및 구성
  - _Requirements: SR-04, SR-05_

- [ ] 2. 핵심 데이터 모델 및 인터페이스 정의
  - [x] 2.1 사용자 및 인증 관련 모델 구현
    - User, UserPreferences, UserPermissions 인터페이스 구현
    - 사용자 인증 및 권한 관리 관련 타입 정의
    - _Requirements: 1.1, 1.2, 1.3_

  - [x] 2.2 데이터베이스 연결 관련 모델 구현
    - Database, ConnectionConfig, DatabaseSchema 인터페이스 구현
    - 테이블, 컬럼, 외래 키 등 DB 구조 관련 타입 정의
    - _Requirements: 2.1, 2.2, 2.3_

  - [x] 2.3 쿼리 및 결과 관련 모델 구현
    - Query, QueryResult, Report, Visualization 인터페이스 구현
    - 쿼리 상태, 결과 형식 등 관련 타입 정의
    - _Requirements: 3.1, 4.1, 5.1, 5.2_

- [x] 3. 백엔드 API 서버 기본 구조 구현
  - [x] 3.1 FastAPI 기반 서버 설정
    - 기본 서버 설정, 미들웨어 구성
    - 라우터 구조 설정
    - 오류 처리 미들웨어 구현
    - _Requirements: SR-04_

  - [x] 3.2 인증 및 권한 관리 API 구현
    - 로그인/로그아웃 엔드포인트 구현
    - JWT 기반 인증 시스템 구현
    - 권한 검증 미들웨어 구현
    - 단위 테스트 작성
    - _Requirements: 1.1, 1.3, 1.4, 1.5_

  - [x] 3.3 데이터베이스 연결 관리 API 구현
    - DB 목록 조회 엔드포인트 구현
    - DB 연결 엔드포인트 구현
    - DB 스키마 조회 엔드포인트 구현
    - 단위 테스트 작성
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 4. 데이터베이스 커넥터 구현
  - [x] 4.1 DB 커넥터 인터페이스 정의
    - 공통 DB 커넥터 인터페이스 설계
    - 연결 풀 관리 기능 구현
    - 쿼리 실행 및 결과 처리 기능 구현
    - _Requirements: SR-01, SR-02, 4.1_

  - [x] 4.2 MS-SQL 커넥터 구현
    - MS-SQL 연결 및 인증 구현
    - 쿼리 실행 및 결과 변환 구현
    - 오류 처리 및 재시도 로직 구현
    - 단위 테스트 작성
    - _Requirements: SR-01, SR-02, 4.1, 4.2, 4.3_

  - [x] 4.3 SAP HANA 커넥터 구현
    - SAP HANA 연결 및 인증 구현
    - 쿼리 실행 및 결과 변환 구현
    - 오류 처리 및 재시도 로직 구현
    - 단위 테스트 작성
    - _Requirements: SR-01, SR-02, 4.1, 4.2, 4.3_
-
  - [x] 4.4 DB 방언 처리 유틸리티 구현
    - MS-SQL과 SAP HANA 간 SQL 문법 차이 처리
    - 자동 SQL 변환 기능 구현
    - 단위 테스트 작성
    - _Requirements: 4.6, NFR-02_

- [ ] 5. LLM 서비스 통합 구현
  - [x] 5.1 LLM 서비스 인터페이스 정의
    - 공통 LLM 서비스 인터페이스 설계
    - 프롬프트 생성 및 처리 유틸리티 구현
    - 응답 파싱 및 검증 유틸리티 구현
    - _Requirements: SR-03, 3.1_

  - [x] 5.2 자연어-SQL 변환 서비스 구현
    - DB 스키마 정보를 활용한 프롬프트 생성 구현
    - 자연어 질의를 SQL로 변환하는 로직 구현
    - 컨텍스트 관리 및 대화 이력 처리 구현
    - 단위 테스트 작성
    - _Requirements: 3.1, 3.2, 3.5, 3.6, 3.7_

  - [x] 5.3 SQL 검증 및 최적화 구현
    - 생성된 SQL의 문법 검증 구현
    - SQL 인젝션 방지 및 보안 검사 구현
    - 쿼리 최적화 제안 기능 구현
    - 단위 테스트 작성
    - _Requirements: 4.1, 4.2, 4.3, 10.1, 10.3_

  - [x] 5.4 결과 요약 서비스 구현
    - 쿼리 결과 데이터 분석 로직 구현
    - 자연어 요약 생성 기능 구현
    - 인사이트 추출 기능 구현
    - 단위 테스트 작성
    - _Requirements: 5.2_

- [-] 6. RAG 시스템 구현
  - [ ] 6.1 문서 인덱싱 시스템 구현






    - DB 스키마 및 메타데이터 수집 기능 구현
    - 텍스트 처리 및 정규화 유틸리티 구현
    - 임베딩 생성 및 저장 기능 구현
    - 단위 테스트 작성
    - _Requirements: 3.3, 3.4_

  - [ ] 6.2 검색 엔진 구현
    - 키워드 기반 검색 기능 구현
    - 임베딩 유사도 기반 검색 기능 구현
    - 하이브리드 검색 알고리즘 구현
    - 단위 테스트 작성
    - _Requirements: 3.3, 3.4_

  - [ ] 6.3 RAG 기반 응답 생성 구현
    - 검색 결과를 기반으로 컨텍스트 구성 기능 구현
    - LLM을 활용한 응답 생성 기능 구현
    - 소스 인용 및 참조 기능 구현
    - 단위 테스트 작성
    - _Requirements: 3.3, 3.4_

- [ ] 7. 파이썬 인터프리터 및 데이터 분석 기능 구현
  - [ ] 7.1 로컬 환경에서 파이썬 코드 실행
    - 서버 로컬 환경에서 직접 파이썬 코드 실행
    - 실행 시간 및 리소스 제한 로직 적용 (타임아웃, 메모리 등)
    - 실행 중 취소 기능 구현
    - _Requirements: 5.3, 5.4_

  - [ ] 7.2 데이터 분석 라이브러리 통합
    - pandas, numpy 등 데이터 분석 라이브러리 통합
    - 데이터 로딩 및 전처리 유틸리티 구현
    - 통계 분석 기능 구현
    - 단위 테스트 작성
    - _Requirements: 5.3, 5.5_

  - [ ] 7.3 데이터 시각화 기능 구현
    - matplotlib, plotly 등 시각화 라이브러리 통합
    - 차트 생성 및 렌더링 기능 구현
    - 시각화 결과 저장 및 전송 기능 구현
    - 단위 테스트 작성
    - _Requirements: 5.3, 5.5, 5.6_

  - [ ] 7.4 리포트 생성 기능 구현
    - 분석 결과와 시각화를 통합한 리포트 생성 기능 구현
    - 단위 테스트 작성
    - _Requirements: 5.3, 5.5_

- [ ] 8. 쿼리 API 및 결과 처리 구현
  - [ ] 8.1 자연어 질의 처리 API 구현
    - 자연어 질의 입력 및 처리 엔드포인트 구현
    - SQL 변환 결과 확인 및 수정 기능 구현
    - RAG 시스템 전환 옵션 구현
    - 단위 테스트 작성
    - _Requirements: 3.1, 3.2, 3.3, 3.4_

  - [ ] 8.2 SQL 쿼리 실행 API 구현
    - SQL 쿼리 실행 엔드포인트 구현
    - 쿼리 상태 모니터링 및 취소 기능 구현
    - 장시간 실행 쿼리 처리 기능 구현
    - 단위 테스트 작성
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_

  - [ ] 8.3 결과 처리 및 표시 API 구현
    - 쿼리 결과 포맷팅 및 페이지네이션 구현
    - 결과 요약 생성 엔드포인트 구현
    - 리포트 생성 요청 및 상태 모니터링 구현
    - 단위 테스트 작성
    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 9. 이력 관리 및 공유 기능 구현
  - [ ] 9.1 쿼리 이력 저장 및 관리 구현
    - 쿼리 및 결과 자동 저장 기능 구현
    - 이력 조회 및 필터링 API 구현
    - 즐겨찾기 및 태그 기능 구현
    - 단위 테스트 작성
    - _Requirements: 6.1, 6.2, 6.3_

  - [ ] 9.2 쿼리 및 결과 공유 기능 구현
    - 공유 링크 생성 API 구현
    - 접근 권한 관리 및 만료 설정 구현
    - 공유된 쿼리/결과 조회 기능 구현
    - 단위 테스트 작성
    - _Requirements: 6.4, 6.5_

- [ ] 10. 오류 처리 및 피드백 시스템 구현
  - [ ] 10.1 구조화된 오류 처리 시스템 구현
    - 오류 유형 분류 및 코드 체계 구현
    - 사용자 친화적 오류 메시지 생성 기능 구현
    - 오류 로깅 및 추적 기능 구현
    - 단위 테스트 작성
    - _Requirements: 7.1, 7.2, 7.3_

  - [ ] 10.2 사용자 피드백 시스템 구현
    - 피드백 제출 및 저장 API 구현
    - 피드백 분석 및 분류 기능 구현
    - 관리자 알림 기능 구현
    - 단위 테스트 작성
    - _Requirements: 7.4, 7.5_

- [ ] 11. 관리자 기능 구현
  - [ ] 11.1 관리자 대시보드 API 구현
    - 사용 통계 및 로그 조회 API 구현
    - 사용자 관리 API 구현
    - 시스템 상태 모니터링 API 구현
    - 단위 테스트 작성
    - _Requirements: 8.1_

  - [ ] 11.2 정책 관리 기능 구현
    - 사용자 권한 설정 API 구현
    - 쿼리 제한 정책 설정 API 구현
    - 보안 정책 설정 API 구현
    - 단위 테스트 작성
    - _Requirements: 8.2, 8.3_

  - [ ] 11.3 시스템 설정 및 백업 기능 구현
    - DB 연결 정보 및 API 키 관리 기능 구현
    - 시스템 설정 관리 API 구현
    - 백업 생성 및 복원 기능 구현
    - 단위 테스트 작성
    - _Requirements: 8.4, 8.6_

- [ ] 12. 프론트엔드 기본 구조 구현
  - [ ] 12.1 React 프로젝트 설정
    - 프로젝트 구조 설정 및 라우팅 구현
    - 상태 관리 설정 (Redux/Vuex)
    - 공통 컴포넌트 및 유틸리티 구현
    - _Requirements: SR-05, SR-06_

  - [ ] 12.2 인증 및 사용자 관리 UI 구현
    - 로그인/로그아웃 화면 구현
    - 사용자 프로필 및 설정 화면 구현
    - 권한 기반 UI 조건부 렌더링 구현
    - 단위 테스트 작성
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 13. 메인 애플리케이션 UI 구현
  - [ ] 13.1 대시보드 및 DB 선택 UI 구현
    - 메인 대시보드 레이아웃 구현
    - DB 선택 및 연결 상태 표시 UI 구현
    - 연결 오류 처리 및 피드백 UI 구현
    - 단위 테스트 작성
    - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_

  - [ ] 13.2 자연어 질의 입력 및 처리 UI 구현
    - 질의 입력 폼 및 제출 기능 구현
    - SQL 변환 결과 표시 및 확인 UI 구현
    - RAG 시스템 전환 옵션 UI 구현
    - 단위 테스트 작성
    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_

  - [ ] 13.3 쿼리 결과 표시 UI 구현
    - 테이블 형식 결과 표시 컴포넌트 구현
    - 정렬 및 필터링 기능 구현
    - 페이지네이션 및 대용량 데이터 처리 UI 구현
    - 단위 테스트 작성
    - _Requirements: 5.1, 5.2_

  - [ ] 13.4 리포트 생성 및 표시 UI 구현
    - 리포트 생성 토글 및 옵션 UI 구현
    - 진행 상태 표시 컴포넌트 구현
    - 시각화 및 인사이트 표시 컴포넌트 구현
    - 단위 테스트 작성
    - _Requirements: 5.3, 5.4, 5.5, 5.6_

- [ ] 14. 이력 및 공유 UI 구현
  - [ ] 14.1 쿼리 이력 관리 UI 구현
    - 이력 목록 및 필터링 UI 구현
    - 이력 항목 상세 보기 및 재실행 기능 구현
    - 즐겨찾기 및 태그 관리 UI 구현
    - 단위 테스트 작성
    - _Requirements: 6.1, 6.2, 6.3_

  - [ ] 14.2 공유 기능 UI 구현
    - 공유 링크 생성 및 관리 UI 구현
    - 접근 권한 설정 UI 구현
    - 공유된 쿼리/결과 표시 UI 구현
    - 단위 테스트 작성
    - _Requirements: 6.4, 6.5_

- [ ] 15. 관리자 UI 구현
  - [ ] 15.1 관리자 대시보드 UI 구현
    - 사용 통계 및 차트 컴포넌트 구현
    - 로그 조회 및 필터링 UI 구현
    - 시스템 상태 모니터링 UI 구현
    - 단위 테스트 작성
    - _Requirements: 8.1_

  - [ ] 15.2 사용자 및 정책 관리 UI 구현
    - 사용자 목록 및 관리 UI 구현
    - 권한 설정 UI 구현
    - 쿼리 제한 정책 설정 UI 구현
    - 단위 테스트 작성
    - _Requirements: 8.2, 8.3_

  - [ ] 15.3 시스템 설정 UI 구현
    - DB 연결 정보 관리 UI 구현
    - API 키 관리 UI 구현
    - 백업 및 복원 UI 구현
    - 단위 테스트 작성
    - _Requirements: 8.4, 8.6_

- [ ] 16. 통합 테스트 및 최적화
  - [ ] 16.1 엔드투엔드 테스트 구현
    - 주요 사용자 시나리오 테스트 구현
    - UI 상호작용 테스트 구현
    - 오류 시나리오 테스트 구현
    - _Requirements: 모든 기능 요구사항_

  - [ ] 16.2 성능 테스트 및 최적화
    - 부하 테스트 구현 및 실행
    - 병목 지점 식별 및 최적화
    - 대용량 데이터 처리 테스트 및 최적화
    - _Requirements: 9.1, 9.2, 9.5_

  - [ ] 16.3 보안 테스트 및 강화
    - 취약점 스캔 및 패치
    - 인증 및 권한 테스트
    - SQL 인젝션 방지 테스트
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5, 10.6_

- [ ] 17. 문서화 및 배포 준비
  - [ ] 17.1 API 문서화
    - OpenAPI/Swagger 문서 작성
    - API 사용 예제 및 가이드 작성
    - 오류 코드 및 처리 방법 문서화
    - _Requirements: 모든 API 관련 요구사항_

  - [ ] 17.2 사용자 매뉴얼 작성
    - 기능별 사용 가이드 작성
    - 자주 묻는 질문(FAQ) 작성
    - 문제 해결 가이드 작성
    - _Requirements: 모든 UI 관련 요구사항_